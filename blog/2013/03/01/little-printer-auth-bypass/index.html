
<!DOCTYPE HTML>
<html>
<head>
	<meta name="google-site-verification" content="f1OtvP7JCHm6M9Ca7vMcFg3q-1NEOvDMcSKfKlVW_pA" />
	<script data-cfasync="false" type="text/javascript" src="//use.typekit.net/axj3cfp.js"></script>
	<script data-cfasync="false" type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<meta charset="utf-8">
	<title>Little Printer Auth Bypass  | Runa A. Sandvik</title>

<meta name="author" content="Runa A. Sandvik"> 

<meta name="description" content="The Little Printer, created by
BERG, holds a compact, inkless, thermal
printer and prints messages filled with things like your schedule,
tweets, &hellip;"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Runa A. Sandvik" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css" media="screen" />
<script type="text/javascript" src="/fancybox/jquery.fancybox.pack.js"></script>

<script language="Javascript" type="text/javascript">
$(document).ready(
  function() {
    (function($) {
      $(".fancybox[data-content-id]").each(function() {
        this.href = $(this).data('content-id');
      });
      $(".fancybox").fancybox({
        beforeLoad: function() {
          var el, 
              id = $(this.element).data('title-id');

          if (id) {
            el = $('#' + id);

            if (el.length) {
              this.title = el.html();
            }
          }
          if ($(this).data('content')) {
            this.content = $(this).data('content');
          }
        },
        helpers: {
          title: {
            type: 'inside'
          }
        }
      });
    })(jQuery);
  }
);
</script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Runa A. Sandvik</a></h1>
<h4></h4>
<nav id="main-nav"><ul>
	<li><a href="/">Blog</a></li>
	<li><a href="/about">About</a></li>
	<li><a href="/portfolio">Portfolio</a></li>
	<li><a href="/archives">Archive</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul>
	<li><a href="/">Blog</a></li>
	<li><a href="/about">About</a></li>
	<li><a href="/portfolio">Portfolio</a></li>
	<li><a href="/archives">Archive</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:blog.encrypted.cc">
			</form>
		</div>
	</div>
</nav>


</header>

	<div id="content" class="inner"><article class="post">
	<h2 class="title">Little Printer Auth Bypass</h2>
	<div class="entry-content"><p>The <a href="http://bergcloud.com/littleprinter/">Little Printer</a>, created by
<a href="http://berglondon.com/">BERG</a>, holds a compact, inkless, thermal
printer and prints messages filled with things like your schedule,
tweets, news headlines and friendsâ€™ birthdays.</p>

<p><img class="center" src="/images/littleprinter.jpg"></p>

<p>The website <a href="http://remote.bergcloud.com/">remote.bergcloud.com</a> is used
to communicate with the Little Printer; set up print subscriptions, send
messages to the printer, give friends permission to send messages, and
so on. I discovered an authentication/authorization bypass issue on this
site which allows an owner of a Little Printer, as well as any user who
has been authorized to print messages to at least one Little Printer, to
print messages to any of the Little Printers out there &#8211; without prior
authorization from the owners.</p>

<p>The HTTP POST which is sent when you message the Little Printer contains
the following payload:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>utf8=%E2%9C%93&authenticity_token=TOKEN&message%5Bbot_id%5D=ID \
</span><span class='line'>&message%5Bstyle%5D=1&message%5Bmessage%5D=Hello!</span></code></pre></td></tr></table></div></figure>


<p>The field <strong>message[bot_id]</strong> contains the ID of the Little Printer,
which is a sequential numeric identifier. Changing the ID allows a user
to send a message to another Little Printer without being authorized by
the owner. The user is also able to print messages without
<strong>authenticity_token</strong> present in the payload.</p>

<p>After printing a message, the site will normally display a box saying
<em>Message sent</em>. When printing to another Little Printer, without really
having permission to do so, the site displays an error and it seems like
printing was not successful. However, that&#8217;s not the case.</p>

<p>I reported this issue directly to Nick Ludlam, the CTO at BERG,
yesterday. He replied an hour later saying that the issue had been
patched on the live system. More information about this can be found in
BERG&#8217;s <a href="http://bergcloud.com/2013/03/01/berg-cloud-security-announcement/">security announcement</a>.</p>
</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-03-01T10:29:00-05:00" pubdate data-updated="true">Mar 1<span>st</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/security/'>security</a>


</div>
	
</div></article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	
<!---	<a class="addthis_counter addthis_pill_style"></a> --->
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <h2 class="title">Comments</h2>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    Runa A. Sandvik

<br>
Powered by Octopress.
</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'encrypted';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.encrypted.cc/blog/2013/03/01/little-printer-auth-bypass/';
        var disqus_url = 'http://blog.encrypted.cc/blog/2013/03/01/little-printer-auth-bypass/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





</body>
</html>
