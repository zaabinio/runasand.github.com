
<!DOCTYPE HTML>
<html>
<head>
	<meta name="google-site-verification" content="f1OtvP7JCHm6M9Ca7vMcFg3q-1NEOvDMcSKfKlVW_pA" />
	<script data-cfasync="false" type="text/javascript" src="//use.typekit.net/axj3cfp.js"></script>
	<script data-cfasync="false" type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<meta charset="utf-8">
	<title>Testing Tor Hidden Services with Burp Pro  | Runa A. Sandvik</title>

<meta name="author" content="Runa A. Sandvik"> 

<meta name="description" content="On February 15, Dafydd Stuttard announced the release of Burp Suite v1.5.05. This release contains a number of feature enhancements and bugfixes, &hellip;"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Runa A. Sandvik" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css" media="screen" />
<script type="text/javascript" src="/fancybox/jquery.fancybox.pack.js"></script>

<script language="Javascript" type="text/javascript">
$(document).ready(
  function() {
    (function($) {
      $(".fancybox[data-content-id]").each(function() {
        this.href = $(this).data('content-id');
      });
      $(".fancybox").fancybox({
        beforeLoad: function() {
          var el, 
              id = $(this.element).data('title-id');

          if (id) {
            el = $('#' + id);

            if (el.length) {
              this.title = el.html();
            }
          }
          if ($(this).data('content')) {
            this.content = $(this).data('content');
          }
        },
        helpers: {
          title: {
            type: 'inside'
          }
        }
      });
    })(jQuery);
  }
);
</script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Runa A. Sandvik</a></h1>
<h4></h4>
<nav id="main-nav"><ul>
	<li><a href="/">Blog</a></li>
	<li><a href="/about">About</a></li>
	<li><a href="/portfolio">Portfolio</a></li>
	<li><a href="/archives">Archive</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul>
	<li><a href="/">Blog</a></li>
	<li><a href="/about">About</a></li>
	<li><a href="/portfolio">Portfolio</a></li>
	<li><a href="/archives">Archive</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:blog.encrypted.cc">
			</form>
		</div>
	</div>
</nav>


</header>

	<div id="content" class="inner"><article class="post">
	<h2 class="title">Testing Tor Hidden Services With Burp Pro</h2>
	<div class="entry-content"><p>On February 15, Dafydd Stuttard announced the release of <a href="http://releases.portswigger.net/2013/02/v1505.html">Burp Suite v1.5.05</a>. This release contains a number of feature enhancements and bugfixes, including an extension to the SOCKS proxy support which allows users to specify that all DNS lookups should be done remotely via the proxy. This means that it is possible to test Tor hidden services with Burp.</p>

<p>This feature is currently only available in Burp Pro, but should eventually make its way into the free edition.</p>

<h3>Tor hidden services</h3>

<p><a href="https://www.torproject.org/docs/hidden-services.html.en">Tor hidden services</a>, sometimes also referred to as the <em>hidden web</em>, <em>dark web</em>, and <em>deep web</em>, were deployed on the Tor network in 2004. Hidden services allow users to host various kinds of resources, such as websites and instant messaging servers, without having their identity or location revealed. Not only does this protect the operators, but also the resources.</p>

<p>A hidden service can only be accessed through its Tor-specific <em>.onion</em> pseudo-<em>top-level domain (TLD)</em>. One example is <a href="http://3g2upl4pq6kufc4m.onion/">3g2upl4pq6kufc4m.onion</a>, which is the address of the <a href="https://duckduckgo.com/">Duck Duck Go</a> search engine. The relays in the Tor network understand the .onion pseudo-TLD and route data anonymously both to and from the hidden service. The IP address, physical location, or operator of a Tor hidden service is never revealed to relays in the Tor network, visitors, or the Tor Project &#8211; as long as the hidden service has been properly <a href="https://www.torproject.org/docs/tor-hidden-service.html.en">configured and secured</a>.</p>

<h3>Tor hidden services and Burp</h3>

<p>To test a Tor hidden service with Burp, make sure the Tor Browser, Tor, and Burp can all talk to each other:</p>

<ul>
<li>Download the <a href="https://www.torproject.org/download/download-easy.html.en">Tor Browser Bundle</a>, <a href="https://www.torproject.org/docs/verifying-signatures.html.en">verify the signature</a>, and get it up and running</li>
<li>Figure out which SOCKS port the Tor Browser is using to talk to Tor: <em>Preferences</em>, <em>Advanced</em>, <em>Network</em>, <em>Settings</em> (next to <em>Configure how TorBrowser connects to the Internet</em>)</li>
<li>Configure Burp to use the same SOCKS proxy as the Tor Browser: <em>Options</em>, <em>Connections</em>, scroll down to the SOCKS proxy section, enter the host and port, and tick <em>Use SOCKS proxy</em> and <em>Do DNS lookups over SOCKS proxy</em></li>
<li>Configure the Tor Browser to use Burp as an HTTP Proxy: on the proxy settings page, enter <em>127.0.0.1:8080</em> as the HTTP proxy and tick <em>Use this proxy for all server protocols</em></li>
</ul>


<p>Visiting <a href="http://3g2upl4pq6kufc4m.onion/">3g2upl4pq6kufc4m.onion</a> in the Tor Browser gives the following output in Burp:</p>

<p><img src="/images/burp-tor-hs.png"></p>
</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-02-25T09:33:00-05:00" pubdate data-updated="true">Feb 25<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/security/'>security</a>


</div>
	
</div></article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	
<!---	<a class="addthis_counter addthis_pill_style"></a> --->
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <h2 class="title">Comments</h2>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    Runa A. Sandvik

<br>
Powered by Octopress.
</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'encrypted';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.encrypted.cc/blog/2013/02/25/testing-tor-hidden-services-with-burp-pro/';
        var disqus_url = 'http://blog.encrypted.cc/blog/2013/02/25/testing-tor-hidden-services-with-burp-pro/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





</body>
</html>
